VERSION 0.8
FROM node:alpine

image:
    # Enable community repo and install packages needed for build
    RUN echo "https://dl-cdn.alpinelinux.org/alpine/edge/community" >> /etc/apk/repositories
    RUN apk update && apk add --no-cache bash curl git jq helm yq-go
    RUN npm install -g cdk8s-cli

    # Install things not in package registries
    COPY ./provision /provision
    RUN /provision/install-dyff.sh

    # Set up user and workdir
    RUN adduser -D builder
    USER builder
    WORKDIR /app
